{% extends 'dashboard/base.html' %} {% block content %}
<div id="map-client" style="height: 100vh;"></div>

<form>
    <label>Latitude:</label>
    <input type="text" id="latitude" name="latitude"><br>
    <label>Longitude:</label>
    <input type="text" id="longitude" name="longitude"><br>
</form>

<script>
    var map = L.map('map-client').setView([0, 0], 2);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    var marker = L.marker([0, 0], { draggable: true }).addTo(map);

    // Update input kalau marker digeser
    marker.on('dragend', function (e) {
        var lat = e.target.getLatLng().lat;
        var lng = e.target.getLatLng().lng;
        document.getElementById('latitude').value = lat;
        document.getElementById('longitude').value = lng;
    });

    // Minta lokasi dari browser
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function (position) {
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;

            // Pindah map & marker
            map.setView([lat, lng], 15);
            marker.setLatLng([lat, lng]);

            // Isi input form
            document.getElementById('latitude').value = lat;
            document.getElementById('longitude').value = lng;
        }, function (error) {
            alert("Gagal mendapatkan lokasi: " + error.message);
        });
    } else {
        alert("Browser tidak mendukung geolocation.");
    }
</script>

{% endblock %}