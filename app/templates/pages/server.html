{% extends 'index.html' %} {% block content %} {% load static %}
{% if perms.app.view_server %}
<div class="content-page server">
  <div class="table-wrapper column">
    <div class="header-table column">
      <div class="row title-head-td">
        <i
          class="fa-solid fa-server"
          style="--clr: var(--clr-fourth); --icon-clr: var(--clr-second)"
        ></i>
        <span class="title">Server List</span>
      </div>
    <div class="row wrap gap-10"> 
      {% if perms.app.add_server %}
      <a href="{% url 'add-server' %}" class="success-button">Add Device +</a>
      <button class="main-button" onclick="addServerWithConfig()">Add Device + Config</button></div>
      {% endif %}
    </div>

    
    <div class="table-container">
      <table class="table" id="table">
       <thead>
         <tr class="t-head">
          <th>#</th>
          <th>Nama Perangkat</th>
          <th>Host IP</th>
          <th>Username</th>
          <th>Server GenieACS</th>

          <th class="center-th">Action</th>
        </tr>
       </thead>
       <tbody>
        {% for server in servers %}
        <tr class="t-d">
          <td>{{ server.id }}</td>
          <td>{{ server.name }}</td>
          <td>{{ server.host }}</td>
          <td>{{ server.username }}</td>
          <td>{{ server.genieacs|default:"-" }}</td>

          <td>
            <div class="row button-wrapper">
              <a href="{% url 'detail-server' server.id %}" class="main-button">View</a>
              <button onclick="test_connection('{{ server.host }}', '{{ server.username }}', '{{ server.password }}')" class="success-button" >Test Connection</button>
            </div>
          </td>
        {% endfor %}
       </tbody>
      </table>
    </div>

  
  </div>
</div>



<script>
  $(document).ready(function () {
    $("#table").DataTable({
      pageLength: 10,
      searching: true,
      // stateSave: true,
      columnDefs: [
      { targets: [5], orderable: false, searchable: false }
        ]
    });
  });
</script>


{% else %}
  <p class="text-danger">Kamu tidak punya izin untuk melihat data server.</p>
{% endif %}

{% endblock %}
